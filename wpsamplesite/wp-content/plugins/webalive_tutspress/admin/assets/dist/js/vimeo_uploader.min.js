!function($){"use strict";$(".watp-tabs li a").on("click",function(e){e.preventDefault(),$(".watp-tabs li a").removeClass("active"),$(this).addClass("active");var tab=$(this).attr("href");$(".watp-settings-tab").removeClass("active"),$(".watp-settings-tabs").find(tab).addClass("active")}),$(".vimeo-video-file").on("change",function(e){var fileName=e.target.files[0].name;$(".file-name").text(fileName)});var appendTo,template;appendTo=$("#watp-album-create-form-appender"),template=wp.template("watp-album-form-template"),appendTo.html(template({title:"Create Album"})),$(document.body).on("submit","#watp-create-album",function(e){e.preventDefault(),$(".loader-status").addClass("loading").html("Creating..."),$.ajax({url:admin_localizer.ajax_url,type:"post",data:{action:"create_vimeo_album",fields:$("#watp-create-album").serialize(),security:admin_localizer.ajax_nonce},success:function(response){var flag=JSON.parse(response);flag.error?swal("Error occured!",flag.error,"error"):(swal("Album Created","","success"),$("#watp-create-album")[0].reset(),albumList()),$(".loader-status").empty().removeClass("loading")}})});var albumList=function(){var appendTo=$("#watp-album-list-form"),template=wp.template("watp-album-list");$(".loader-status").addClass("loading").html("Loading..."),$.ajax({url:admin_localizer.ajax_url,method:"get",data:{action:"fetch_albums"},success:function(response){var data=JSON.parse(response);appendTo.html(template(data.data)),$(".loader-status").empty().removeClass("loading")}})};albumList();$(document.body).on("click",".watp-album-delete",function(e){e.preventDefault(),$(".loader-status").addClass("loading").html("Deleting...");var albumId=$(this).attr("data-link").split(/[/]+/).pop();$.ajax({url:admin_localizer.ajax_url,method:"post",data:{action:"delete_vimeo_album",album_id:albumId,security:admin_localizer.ajax_nonce},success:function(response){swal("Album Deleted","","success"),albumList(),$(".loader-status").empty().removeClass("loading")}})});$(document.body).on("click","#vimeo-edit-album",function(e){e.preventDefault(),$(".loader-status").addClass("loading").html("Editing..."),$.ajax({url:admin_localizer.ajax_url,type:"post",data:{action:"edit_vimeo_album",fields:$("#watp-edit-album").serialize(),security:admin_localizer.ajax_nonce},success:function(response){var flag=JSON.parse(response);console.log(flag),flag.error?swal("Error occured!",flag.error,"error"):(swal("Album Edited","","success"),$("#watp-edit-album")[0].reset(),$("#alter-to-create-album-form").trigger("click")),$(".loader-status").empty().removeClass("loading")}})});$(document.body).on("click","#alter-to-create-album-form",function(e){e.preventDefault(),$("#watp-album-create-form-appender").show(),$("#watp-album-edit-form-appender").hide()});$("form#upload-video-to-album-form").on("submit",function(e){e.preventDefault(),$(".upload-status").addClass("uploading").html("Uploading...");var fileData=$("#watp-video-file").prop("files")[0],fields=$(this).serialize(),security=admin_localizer.ajax_nonce,formData=new FormData;formData.append("file",fileData),formData.append("fields",fields),formData.append("action","upload_video"),formData.append("security",security),$.ajax({url:admin_localizer.ajax_url,type:"post",data:formData,cache:!1,contentType:!1,processData:!1,success:function(response){var flag=JSON.parse(response);if(200==flag.status){var link=flag.link;swal("Video uploaded!",'Visit : <a href="https://vimeo.com/'+link.split(/[/]+/).pop()+'" target="_blank">https://vimeo.com/'+link.split(/[/]+/).pop()+"</a>","success"),$(".upload-status").remove(),$(".vimeo-url").html('Visit : <a href="https://vimeo.com/'+link.split(/[/]+/).pop()+'" target="_blank">https://vimeo.com/'+link.split(/[/]+/).pop()+"</a>"),$("form#upload-video-to-album-form")[0].reset()}else swal("Something went wrong!","","error"),$(".upload-status").remove()}})});!function(){var appendTo=$("#watp-uploaded-video-appender"),template=wp.template("watp-uploaded-video-list");$(".loader-status").addClass("loading").html("Loading..."),$.ajax({url:admin_localizer.ajax_url,type:"post",data:{action:"fetch_all_videos",security:admin_localizer.ajax_nonce},success:function(response){var data=JSON.parse(response);console.log(data),appendTo.html(template(data.data)),$(".loader-status").empty().removeClass("loading")}})}()}(jQuery);